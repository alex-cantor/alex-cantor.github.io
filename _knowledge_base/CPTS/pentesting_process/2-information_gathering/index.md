---
title: Information Gathering
parent: CPTS
grand_parent: Categories
nav_order: 2
has_children: true
layout: default
---

# Information Gathering

## Overview

Information Gathering, also commonly known as **Reconnaissance** or **Recon**, involves discovering as much information as possible about the target **prior to any exploitation**. The goal is to reduce assumptions and build a clear picture of the target environment.

Recon is often split into two phases:

- **Passive Reconnaissance** – No direct interaction with the target
- **Active Reconnaissance** – Direct interaction with the target (e.g., sending packets, scanning)

Both forms of recon are crucial to developing effective attack strategies.

---

## Passive Reconnaissance

Passive Recon is stealthy and indirect. The idea is to gather intel **without touching the target’s systems**, reducing the risk of detection. It is useful in the early stages or when operating under strict RoE.

### Goals

- Identify domain names, IPs, and infrastructure
- Discover public-facing services
- Analyze public personas, emails, and leaks
- Map organizational structure
- Collect publicly exposed credentials

### Techniques

- **Google Dorking**  
  - `site:example.com inurl:login`
  - `intitle:index.of` to find open directories

- **WHOIS Lookup**
  - Discover registrant, contact info, nameservers, etc.
  - Tools: `whois`, [whois.domaintools.com](https://whois.domaintools.com)

- **DNS Enumeration**
  - Passive record gathering (e.g., `dig`, `host`)
  - Subdomain discovery using wordlists (e.g., `crt.sh`, `amass` in passive mode)

- **Certificate Transparency Logs**
  - Discover subdomains through certificates issued
  - Tool: [crt.sh](https://crt.sh)

- **Public Breach Databases**
  - Find leaked credentials or emails
  - Tools: [HaveIBeenPwned](https://haveibeenpwned.com), Dehashed, Snusbase

- **Metadata Extraction**
  - Download public files and extract metadata
  - Tools: `exiftool`, `strings`, FOCA

- **Social Media & OSINT**
  - LinkedIn (for employees, tech stack)
  - Twitter, GitHub (API keys, credentials in code)

### Tools for Passive Recon

- `theHarvester`
- `Maltego`
- `SpiderFoot`
- `Amass` (in passive mode)
- `Recon-ng`
- `FOCA` (Windows metadata tool)

---

## Active Reconnaissance (Step-by-Step)

Active reconnaissance involves **direct interaction** with the target. Choose your level of aggressiveness based on the **Rules of Engagement (RoE)** defined in the pre-engagement phase.

---

### Low-Aggression (Stealthy, Minimal Risk)

Use slower, quieter scans to reduce detection.

#### 1. Ping Sweep (Check if host is alive)

```bash
nmap -sn <target>/24
```

#### 2. SYN Scan (Stealth port scan)

```bash
nmap -sS -T2 -Pn <target>
```

#### 3. Service Version Scan (Quiet)

```bash
nmap -sV -T2 -Pn -p- <target>
```

#### 4. HTTP Header Grab

```bash
curl -I http://<target>
```

#### 5. Banner Grabbing

```bash
nc <target> 80
```

#### 6. DNS Enumeration (Direct lookup)

```bash
nslookup <target>
host <target>
dig <target> any
```

---

### Medium-Aggression (Default for Most Labs & CPTS)

Perform a complete, standard recon with safe but thorough scanning.

#### 1. Full TCP Port Scan + Service Enumeration

```bash
nmap -sS -sV -sC -T4 -p- <target>
```

#### 2. UDP Port Scan (Slower, but important)

```bash
nmap -sU -T4 --top-ports 100 <target>
```

#### 3. OS Detection

```bash
nmap -O -T4 <target>
```

#### 4. HTTP Directory Enumeration

```bash
gobuster dir -u http://<target> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

Alternative:

```bash
ffuf -u http://<target>/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

#### 5. SMB Enumeration

```bash
enum4linux-ng <target>
```

#### 6. SNMP Enumeration (if port 161 open)

```bash
snmpwalk -v2c -c public <target>
```

#### 7. SMTP VRFY Enumeration (if port 25 open)

```bash
nc <target> 25
EHLO test.com
VRFY admin
```

---

### High-Aggression (For CTFs or Full Engagement Permission)

Only use these if you have **explicit permission**, as they are noisy and can cause disruption.

#### 1. Fast Masscan to Identify Open Ports

```bash
masscan <target> -p1-65535 --rate=1000
```

Note: follow up with `nmap` on those specific ports.

#### 2. Full NSE Script Scan

```bash
nmap -sC -sV --script=default,vuln -p- <target>
```

#### 3. Bruteforce Common Credentials (if permitted)

```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://<target>
```

---

### Service-Specific Recon (When Certain Ports Are Found)

| Port | Service | Recon |
|------|---------|-------|
| 21   | FTP     | `ftp <target>` – try anonymous login |
| 22   | SSH     | `ssh <target>` – banner grab / bruteforce |
| 25   | SMTP    | `nc <target> 25` – try `VRFY`, `EXPN` |
| 53   | DNS     | `dig axfr @<target>` |
| 80/443 | HTTP/HTTPS | `gobuster`, `nikto`, `whatweb`, `curl`, browser |
| 139/445 | SMB | `enum4linux-ng`, `smbclient -L //<target>/` |
| 3306 | MySQL | `mysql -u root -h <target> -p` |
| 8080 | WebApp | Visit in browser, often admin panel |

---

### Active Recon Checklist (CPTS Practical Prep)

| Task | Command |
|------|---------|
| Discover live hosts | `nmap -sn <target>/24` |
| Full TCP port scan | `nmap -sS -p- <target>` |
| Version & script scan | `nmap -sC -sV <target>` |
| OS detection | `nmap -O <target>` |
| Web discovery | `gobuster`, `ffuf`, `nikto` |
| SMB enum | `enum4linux-ng <target>` |
| DNS lookup | `dig <target> any` |
| SNMP enum | `snmpwalk -v2c -c public <target>` |
| HTTP headers | `curl -I <target>` |
| Bruteforce (if allowed) | `hydra`, `medusa`, `john` |

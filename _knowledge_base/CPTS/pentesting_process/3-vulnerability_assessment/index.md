---
title: Information Gathering
parent: CPTS
grand_parent: Categories
nav_order: 2
has_children: true
layout: default
---

# Information Gathering

## Overview

Information Gathering, also known as **Reconnaissance**, involves discovering as much intel about a target as possible prior to exploitation. It's typically divided into:

- **Passive Recon**: Gathering information without directly interacting with the target
- **Active Recon**: Interacting directly with the target (e.g., scanning, probing)

---

## Passive Reconnaissance

Passive Recon is stealthy and indirect. It minimizes the chance of being detected while collecting valuable information.

### Goals

- Identify domains, IPs, subdomains
- Collect organizational data (names, emails, structure)
- Discover leaked credentials
- Gather technology stack info
- Extract metadata

### Techniques

- **Google Dorking**  
  - \`site:example.com inurl:login\`  
  - \`intitle:index.of\`

- **WHOIS Lookups**  
  - Discover registrants, contact info, nameservers  
  - Tools: \`whois\`, \`domaintools.com\`

- **DNS Recon**  
  - \`host <target>\`  
  - \`dig <target>\`  
  - \`dnsenum\`

- **Subdomain Enumeration**  
  - Tools: \`amass\`, \`crt.sh\`, \`sublist3r\`

- **Metadata Extraction**  
  - Tools: \`exiftool\`, \`strings\`

- **Public Breach Databases**  
  - Tools: \`haveibeenpwned.com\`, \`dehashed.com\`

- **Social Media OSINT**  
  - LinkedIn, Twitter, GitHub (look for credentials/API keys)

### Tools

- \`theHarvester\`
- \`Maltego\`
- \`SpiderFoot\`
- \`Amass\`
- \`FOCA\`
- \`Google\` / \`crt.sh\` / \`hunter.io\`

---

## Active Reconnaissance (Step-by-Step)

Active reconnaissance involves **direct interaction** with the target. Choose your aggressiveness based on the **Rules of Engagement (RoE)**.

---

### ðŸ”¹ Low-Aggression (Stealthy)

Use quiet scans with minimal risk of detection.

#### 1. Ping Sweep

\`\`\`bash
nmap -sn <target>/24
\`\`\`

#### 2. SYN Scan

\`\`\`bash
nmap -sS -T2 -Pn <target>
\`\`\`

#### 3. Service Detection

\`\`\`bash
nmap -sV -T2 -Pn -p- <target>
\`\`\`

#### 4. HTTP Header Grab

\`\`\`bash
curl -I http://<target>
\`\`\`

#### 5. Banner Grabbing

\`\`\`bash
nc <target> 80
\`\`\`

#### 6. DNS Enumeration

\`\`\`bash
nslookup <target>
host <target>
dig <target> any
\`\`\`

---

### ðŸ”¸ Medium-Aggression (Standard CPTS Labs)

Used for standard, full recon where detection isnâ€™t a concern.

#### 1. TCP Port Scan + Enumeration

\`\`\`bash
nmap -sS -sV -sC -T4 -p- <target>
\`\`\`

#### 2. UDP Scan

\`\`\`bash
nmap -sU --top-ports 100 -T4 <target>
\`\`\`

#### 3. OS Detection

\`\`\`bash
nmap -O -T4 <target>
\`\`\`

#### 4. HTTP Directory Discovery

\`\`\`bash
gobuster dir -u http://<target> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
\`\`\`

Alternative:

\`\`\`bash
ffuf -u http://<target>/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
\`\`\`

#### 5. SMB Enumeration

\`\`\`bash
enum4linux-ng <target>
\`\`\`

#### 6. SNMP Enumeration

\`\`\`bash
snmpwalk -v2c -c public <target>
\`\`\`

#### 7. SMTP Enumeration

\`\`\`bash
nc <target> 25
EHLO test.com
VRFY admin
\`\`\`

---

### ðŸ”º High-Aggression (Full Engagement Permission)

Only use these techniques if **explicitly allowed**.

#### 1. Fast Port Scan (Masscan)

\`\`\`bash
masscan <target> -p1-65535 --rate=1000
\`\`\`

#### 2. NSE Vulnerability Scripts

\`\`\`bash
nmap -sC -sV --script=default,vuln -p- <target>
\`\`\`

#### 3. Credential Bruteforce (if allowed)

\`\`\`bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://<target>
\`\`\`

---

### Service-Specific Recon Table

| Port  | Service | Recon Tips |
|-------|---------|------------|
| 21    | FTP     | \`ftp <target>\` â†’ try anonymous login |
| 22    | SSH     | \`ssh <target>\`, bruteforce if allowed |
| 25    | SMTP    | \`nc <target> 25\` â†’ \`VRFY user\` |
| 53    | DNS     | \`dig axfr @<target>\` |
| 80/443| HTTP/S  | \`gobuster\`, \`nikto\`, browser |
| 139/445| SMB    | \`enum4linux-ng\`, \`smbclient -L\` |
| 3306  | MySQL   | \`mysql -u root -h <target> -p\` |
| 8080  | Web     | Often admin panels or alternate UIs |

---

### âœ… Active Recon Checklist (CPTS Practical)

| Task | Command |
|------|---------|
| Ping sweep | \`nmap -sn <target>/24\` |
| Full port scan | \`nmap -sS -p- <target>\` |
| Version/script scan | \`nmap -sC -sV <target>\` |
| OS detection | \`nmap -O <target>\` |
| HTTP fuzzing | \`gobuster\`, \`ffuf\` |
| SMB enum | \`enum4linux-ng <target>\` |
| SNMP enum | \`snmpwalk -v2c -c public <target>\` |
| Banner grabbing | \`nc\`, \`curl\` |
| Bruteforce (if allowed) | \`hydra\`, \`medusa\` |
